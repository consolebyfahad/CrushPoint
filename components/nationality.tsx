import { color, font } from "@/utils/constants";
import { Ionicons } from "@expo/vector-icons";
import React, { useState } from "react";
import { useTranslation } from "react-i18next";
import {
  Dimensions,
  FlatList,
  StyleSheet,
  Text,
  TextInput,
  TouchableOpacity,
  View,
} from "react-native";

const { height: SCREEN_HEIGHT } = Dimensions.get("window");

export default function Nationality({
  onClose,
  onBack,
  filterData,
  setFilterData,
}: any) {
  const { t } = useTranslation();
  const [searchText, setSearchText] = useState("");
  const [selectedNationalities, setSelectedNationalities] = useState<string[]>(
    Array.isArray(filterData.nationality) ? filterData.nationality : []
  );

  const nationalities = [
    { id: "afghan", name: t("nationalities.afghan"), flag: "ğŸ‡¦ğŸ‡«" },
    { id: "albanian", name: t("nationalities.albanian"), flag: "ğŸ‡¦ğŸ‡±" },
    { id: "algerian", name: t("nationalities.algerian"), flag: "ğŸ‡©ğŸ‡¿" },
    { id: "american", name: t("nationalities.american"), flag: "ğŸ‡ºğŸ‡¸" },
    { id: "andorran", name: t("nationalities.andorran"), flag: "ğŸ‡¦ğŸ‡©" },
    { id: "angolan", name: t("nationalities.angolan"), flag: "ğŸ‡¦ğŸ‡´" },
    { id: "antiguan", name: t("nationalities.antiguan"), flag: "ğŸ‡¦ğŸ‡¬" },
    { id: "argentine", name: t("nationalities.argentine"), flag: "ğŸ‡¦ğŸ‡·" },
    { id: "armenian", name: t("nationalities.armenian"), flag: "ğŸ‡¦ğŸ‡²" },
    { id: "australian", name: t("nationalities.australian"), flag: "ğŸ‡¦ğŸ‡º" },
    { id: "austrian", name: t("nationalities.austrian"), flag: "ğŸ‡¦ğŸ‡¹" },
    { id: "azerbaijani", name: t("nationalities.azerbaijani"), flag: "ğŸ‡¦ğŸ‡¿" },
    { id: "bahamian", name: t("nationalities.bahamian"), flag: "ğŸ‡§ğŸ‡¸" },
    { id: "bahraini", name: t("nationalities.bahraini"), flag: "ğŸ‡§ğŸ‡­" },
    { id: "bangladeshi", name: t("nationalities.bangladeshi"), flag: "ğŸ‡§ğŸ‡©" },
    { id: "barbadian", name: t("nationalities.barbadian"), flag: "ğŸ‡§ğŸ‡§" },
    { id: "belarusian", name: t("nationalities.belarusian"), flag: "ğŸ‡§ğŸ‡¾" },
    { id: "belgian", name: t("nationalities.belgian"), flag: "ğŸ‡§ğŸ‡ª" },
    { id: "belizean", name: t("nationalities.belizean"), flag: "ğŸ‡§ğŸ‡¿" },
    { id: "beninese", name: t("nationalities.beninese"), flag: "ğŸ‡§ğŸ‡¯" },
    { id: "bhutanese", name: t("nationalities.bhutanese"), flag: "ğŸ‡§ğŸ‡¹" },
    { id: "bolivian", name: t("nationalities.bolivian"), flag: "ğŸ‡§ğŸ‡´" },
    { id: "bosnian", name: t("nationalities.bosnian"), flag: "ğŸ‡§ğŸ‡¦" },
    { id: "botswanan", name: t("nationalities.botswanan"), flag: "ğŸ‡§ğŸ‡¼" },
    { id: "brazilian", name: t("nationalities.brazilian"), flag: "ğŸ‡§ğŸ‡·" },
    { id: "british", name: t("nationalities.british"), flag: "ğŸ‡¬ğŸ‡§" },
    { id: "bruneian", name: t("nationalities.bruneian"), flag: "ğŸ‡§ğŸ‡³" },
    { id: "bulgarian", name: t("nationalities.bulgarian"), flag: "ğŸ‡§ğŸ‡¬" },
    { id: "burkinabe", name: t("nationalities.burkinabe"), flag: "ğŸ‡§ğŸ‡«" },
    { id: "burmese", name: t("nationalities.burmese"), flag: "ğŸ‡²ğŸ‡²" },
    { id: "burundian", name: t("nationalities.burundian"), flag: "ğŸ‡§ğŸ‡®" },
    { id: "cambodian", name: t("nationalities.cambodian"), flag: "ğŸ‡°ğŸ‡­" },
    { id: "cameroonian", name: t("nationalities.cameroonian"), flag: "ğŸ‡¨ğŸ‡²" },
    { id: "canadian", name: t("nationalities.canadian"), flag: "ğŸ‡¨ğŸ‡¦" },
    { id: "cape_verdean", name: t("nationalities.cape_verdean"), flag: "ğŸ‡¨ğŸ‡»" },
    {
      id: "central_african",
      name: t("nationalities.central_african"),
      flag: "ğŸ‡¨ğŸ‡«",
    },
    { id: "chadian", name: t("nationalities.chadian"), flag: "ğŸ‡¹ğŸ‡©" },
    { id: "chilean", name: t("nationalities.chilean"), flag: "ğŸ‡¨ğŸ‡±" },
    { id: "chinese", name: t("nationalities.chinese"), flag: "ğŸ‡¨ğŸ‡³" },
    { id: "colombian", name: t("nationalities.colombian"), flag: "ğŸ‡¨ğŸ‡´" },
    { id: "comoran", name: t("nationalities.comoran"), flag: "ğŸ‡°ğŸ‡²" },
    { id: "congolese", name: t("nationalities.congolese"), flag: "ğŸ‡¨ğŸ‡©" },
    { id: "costa_rican", name: t("nationalities.costa_rican"), flag: "ğŸ‡¨ğŸ‡·" },
    { id: "croatian", name: t("nationalities.croatian"), flag: "ğŸ‡­ğŸ‡·" },
    { id: "cuban", name: t("nationalities.cuban"), flag: "ğŸ‡¨ğŸ‡º" },
    { id: "cypriot", name: t("nationalities.cypriot"), flag: "ğŸ‡¨ğŸ‡¾" },
    { id: "czech", name: t("nationalities.czech"), flag: "ğŸ‡¨ğŸ‡¿" },
    { id: "danish", name: t("nationalities.danish"), flag: "ğŸ‡©ğŸ‡°" },
    { id: "djiboutian", name: t("nationalities.djiboutian"), flag: "ğŸ‡©ğŸ‡¯" },
    { id: "dominican", name: t("nationalities.dominican"), flag: "ğŸ‡©ğŸ‡²" },
    { id: "dutch", name: t("nationalities.dutch"), flag: "ğŸ‡³ğŸ‡±" },
    { id: "ecuadorian", name: t("nationalities.ecuadorian"), flag: "ğŸ‡ªğŸ‡¨" },
    { id: "egyptian", name: t("nationalities.egyptian"), flag: "ğŸ‡ªğŸ‡¬" },
    { id: "emirati", name: t("nationalities.emirati"), flag: "ğŸ‡¦ğŸ‡ª" },
    {
      id: "equatorial_guinean",
      name: t("nationalities.equatorial_guinean"),
      flag: "ğŸ‡¬ğŸ‡¶",
    },
    { id: "eritrean", name: t("nationalities.eritrean"), flag: "ğŸ‡ªğŸ‡·" },
    { id: "estonian", name: t("nationalities.estonian"), flag: "ğŸ‡ªğŸ‡ª" },
    { id: "ethiopian", name: t("nationalities.ethiopian"), flag: "ğŸ‡ªğŸ‡¹" },
    { id: "fijian", name: t("nationalities.fijian"), flag: "ğŸ‡«ğŸ‡¯" },
    { id: "filipino", name: t("nationalities.filipino"), flag: "ğŸ‡µğŸ‡­" },
    { id: "finnish", name: t("nationalities.finnish"), flag: "ğŸ‡«ğŸ‡®" },
    { id: "french", name: t("nationalities.french"), flag: "ğŸ‡«ğŸ‡·" },
    { id: "gabonese", name: t("nationalities.gabonese"), flag: "ğŸ‡¬ğŸ‡¦" },
    { id: "gambian", name: t("nationalities.gambian"), flag: "ğŸ‡¬ğŸ‡²" },
    { id: "georgian", name: t("nationalities.georgian"), flag: "ğŸ‡¬ğŸ‡ª" },
    { id: "german", name: t("nationalities.german"), flag: "ğŸ‡©ğŸ‡ª" },
    { id: "ghanaian", name: t("nationalities.ghanaian"), flag: "ğŸ‡¬ğŸ‡­" },
    { id: "greek", name: t("nationalities.greek"), flag: "ğŸ‡¬ğŸ‡·" },
    { id: "grenadian", name: t("nationalities.grenadian"), flag: "ğŸ‡¬ğŸ‡©" },
    { id: "guatemalan", name: t("nationalities.guatemalan"), flag: "ğŸ‡¬ğŸ‡¹" },
    { id: "guinean", name: t("nationalities.guinean"), flag: "ğŸ‡¬ğŸ‡³" },
    { id: "guyanese", name: t("nationalities.guyanese"), flag: "ğŸ‡¬ğŸ‡¾" },
    { id: "haitian", name: t("nationalities.haitian"), flag: "ğŸ‡­ğŸ‡¹" },
    { id: "honduran", name: t("nationalities.honduran"), flag: "ğŸ‡­ğŸ‡³" },
    { id: "hungarian", name: t("nationalities.hungarian"), flag: "ğŸ‡­ğŸ‡º" },
    { id: "icelandic", name: t("nationalities.icelandic"), flag: "ğŸ‡®ğŸ‡¸" },
    { id: "indian", name: t("nationalities.indian"), flag: "ğŸ‡®ğŸ‡³" },
    { id: "indonesian", name: t("nationalities.indonesian"), flag: "ğŸ‡®ğŸ‡©" },
    { id: "iranian", name: t("nationalities.iranian"), flag: "ğŸ‡®ğŸ‡·" },
    { id: "iraqi", name: t("nationalities.iraqi"), flag: "ğŸ‡®ğŸ‡¶" },
    { id: "irish", name: t("nationalities.irish"), flag: "ğŸ‡®ğŸ‡ª" },
    { id: "israeli", name: t("nationalities.israeli"), flag: "ğŸ‡®ğŸ‡±" },
    { id: "italian", name: t("nationalities.italian"), flag: "ğŸ‡®ğŸ‡¹" },
    { id: "ivorian", name: t("nationalities.ivorian"), flag: "ğŸ‡¨ğŸ‡®" },
    { id: "jamaican", name: t("nationalities.jamaican"), flag: "ğŸ‡¯ğŸ‡²" },
    { id: "japanese", name: t("nationalities.japanese"), flag: "ğŸ‡¯ğŸ‡µ" },
    { id: "jordanian", name: t("nationalities.jordanian"), flag: "ğŸ‡¯ğŸ‡´" },
    { id: "kazakhstani", name: t("nationalities.kazakhstani"), flag: "ğŸ‡°ğŸ‡¿" },
    { id: "kenyan", name: t("nationalities.kenyan"), flag: "ğŸ‡°ğŸ‡ª" },
    { id: "kiribati", name: t("nationalities.kiribati"), flag: "ğŸ‡°ğŸ‡®" },
    { id: "korean", name: t("nationalities.korean"), flag: "ğŸ‡°ğŸ‡·" },
    { id: "kuwaiti", name: t("nationalities.kuwaiti"), flag: "ğŸ‡°ğŸ‡¼" },
    { id: "kyrgyzstani", name: t("nationalities.kyrgyzstani"), flag: "ğŸ‡°ğŸ‡¬" },
    { id: "laotian", name: t("nationalities.laotian"), flag: "ğŸ‡±ğŸ‡¦" },
    { id: "latvian", name: t("nationalities.latvian"), flag: "ğŸ‡±ğŸ‡»" },
    { id: "lebanese", name: t("nationalities.lebanese"), flag: "ğŸ‡±ğŸ‡§" },
    { id: "liberian", name: t("nationalities.liberian"), flag: "ğŸ‡±ğŸ‡·" },
    { id: "libyan", name: t("nationalities.libyan"), flag: "ğŸ‡±ğŸ‡¾" },
    { id: "liechtenstein", name: t("nationalities.liechtenstein"), flag: "ğŸ‡±ğŸ‡®" },
    { id: "lithuanian", name: t("nationalities.lithuanian"), flag: "ğŸ‡±ğŸ‡¹" },
    { id: "luxembourgish", name: t("nationalities.luxembourgish"), flag: "ğŸ‡±ğŸ‡º" },
    { id: "macedonian", name: t("nationalities.macedonian"), flag: "ğŸ‡²ğŸ‡°" },
    { id: "malagasy", name: t("nationalities.malagasy"), flag: "ğŸ‡²ğŸ‡¬" },
    { id: "malawian", name: t("nationalities.malawian"), flag: "ğŸ‡²ğŸ‡¼" },
    { id: "malaysian", name: t("nationalities.malaysian"), flag: "ğŸ‡²ğŸ‡¾" },
    { id: "maldivian", name: t("nationalities.maldivian"), flag: "ğŸ‡²ğŸ‡»" },
    { id: "malian", name: t("nationalities.malian"), flag: "ğŸ‡²ğŸ‡±" },
    { id: "maltese", name: t("nationalities.maltese"), flag: "ğŸ‡²ğŸ‡¹" },
    { id: "marshallese", name: t("nationalities.marshallese"), flag: "ğŸ‡²ğŸ‡­" },
    { id: "mauritanian", name: t("nationalities.mauritanian"), flag: "ğŸ‡²ğŸ‡·" },
    { id: "mauritian", name: t("nationalities.mauritian"), flag: "ğŸ‡²ğŸ‡º" },
    { id: "mexican", name: t("nationalities.mexican"), flag: "ğŸ‡²ğŸ‡½" },
    { id: "micronesian", name: t("nationalities.micronesian"), flag: "ğŸ‡«ğŸ‡²" },
    { id: "moldovan", name: t("nationalities.moldovan"), flag: "ğŸ‡²ğŸ‡©" },
    { id: "monacan", name: t("nationalities.monacan"), flag: "ğŸ‡²ğŸ‡¨" },
    { id: "mongolian", name: t("nationalities.mongolian"), flag: "ğŸ‡²ğŸ‡³" },
    { id: "montenegrin", name: t("nationalities.montenegrin"), flag: "ğŸ‡²ğŸ‡ª" },
    { id: "moroccan", name: t("nationalities.moroccan"), flag: "ğŸ‡²ğŸ‡¦" },
    { id: "mozambican", name: t("nationalities.mozambican"), flag: "ğŸ‡²ğŸ‡¿" },
    { id: "namibian", name: t("nationalities.namibian"), flag: "ğŸ‡³ğŸ‡¦" },
    { id: "nauruan", name: t("nationalities.nauruan"), flag: "ğŸ‡³ğŸ‡·" },
    { id: "nepalese", name: t("nationalities.nepalese"), flag: "ğŸ‡³ğŸ‡µ" },
    { id: "new_zealand", name: t("nationalities.new_zealand"), flag: "ğŸ‡³ğŸ‡¿" },
    { id: "nicaraguan", name: t("nationalities.nicaraguan"), flag: "ğŸ‡³ğŸ‡®" },
    { id: "nigerian", name: t("nationalities.nigerian"), flag: "ğŸ‡³ğŸ‡¬" },
    { id: "nigerien", name: t("nationalities.nigerien"), flag: "ğŸ‡³ğŸ‡ª" },
    { id: "north_korean", name: t("nationalities.north_korean"), flag: "ğŸ‡°ğŸ‡µ" },
    { id: "norwegian", name: t("nationalities.norwegian"), flag: "ğŸ‡³ğŸ‡´" },
    { id: "omani", name: t("nationalities.omani"), flag: "ğŸ‡´ğŸ‡²" },
    { id: "pakistani", name: t("nationalities.pakistani"), flag: "ğŸ‡µğŸ‡°" },
    { id: "palauan", name: t("nationalities.palauan"), flag: "ğŸ‡µğŸ‡¼" },
    { id: "palestinian", name: t("nationalities.palestinian"), flag: "ğŸ‡µğŸ‡¸" },
    { id: "panamanian", name: t("nationalities.panamanian"), flag: "ğŸ‡µğŸ‡¦" },
    {
      id: "papua_new_guinean",
      name: t("nationalities.papua_new_guinean"),
      flag: "ğŸ‡µğŸ‡¬",
    },
    { id: "paraguayan", name: t("nationalities.paraguayan"), flag: "ğŸ‡µğŸ‡¾" },
    { id: "peruvian", name: t("nationalities.peruvian"), flag: "ğŸ‡µğŸ‡ª" },
    { id: "polish", name: t("nationalities.polish"), flag: "ğŸ‡µğŸ‡±" },
    { id: "portuguese", name: t("nationalities.portuguese"), flag: "ğŸ‡µğŸ‡¹" },
    { id: "qatari", name: t("nationalities.qatari"), flag: "ğŸ‡¶ğŸ‡¦" },
    { id: "romanian", name: t("nationalities.romanian"), flag: "ğŸ‡·ğŸ‡´" },
    { id: "russian", name: t("nationalities.russian"), flag: "ğŸ‡·ğŸ‡º" },
    { id: "rwandan", name: t("nationalities.rwandan"), flag: "ğŸ‡·ğŸ‡¼" },
    { id: "saint_kitts", name: t("nationalities.saint_kitts"), flag: "ğŸ‡°ğŸ‡³" },
    { id: "saint_lucian", name: t("nationalities.saint_lucian"), flag: "ğŸ‡±ğŸ‡¨" },
    {
      id: "saint_vincentian",
      name: t("nationalities.saint_vincentian"),
      flag: "ğŸ‡»ğŸ‡¨",
    },
    { id: "samoan", name: t("nationalities.samoan"), flag: "ğŸ‡¼ğŸ‡¸" },
    { id: "san_marinese", name: t("nationalities.san_marinese"), flag: "ğŸ‡¸ğŸ‡²" },
    { id: "sao_tomean", name: t("nationalities.sao_tomean"), flag: "ğŸ‡¸ğŸ‡¹" },
    { id: "saudi_arabian", name: t("nationalities.saudi_arabian"), flag: "ğŸ‡¸ğŸ‡¦" },
    { id: "senegalese", name: t("nationalities.senegalese"), flag: "ğŸ‡¸ğŸ‡³" },
    { id: "serbian", name: t("nationalities.serbian"), flag: "ğŸ‡·ğŸ‡¸" },
    { id: "seychellois", name: t("nationalities.seychellois"), flag: "ğŸ‡¸ğŸ‡¨" },
    {
      id: "sierra_leonean",
      name: t("nationalities.sierra_leonean"),
      flag: "ğŸ‡¸ğŸ‡±",
    },
    { id: "singaporean", name: t("nationalities.singaporean"), flag: "ğŸ‡¸ğŸ‡¬" },
    { id: "slovak", name: t("nationalities.slovak"), flag: "ğŸ‡¸ğŸ‡°" },
    { id: "slovenian", name: t("nationalities.slovenian"), flag: "ğŸ‡¸ğŸ‡®" },
    {
      id: "solomon_islander",
      name: t("nationalities.solomon_islander"),
      flag: "ğŸ‡¸ğŸ‡§",
    },
    { id: "somali", name: t("nationalities.somali"), flag: "ğŸ‡¸ğŸ‡´" },
    { id: "south_african", name: t("nationalities.south_african"), flag: "ğŸ‡¿ğŸ‡¦" },
    { id: "south_korean", name: t("nationalities.south_korean"), flag: "ğŸ‡°ğŸ‡·" },
    {
      id: "south_sudanese",
      name: t("nationalities.south_sudanese"),
      flag: "ğŸ‡¸ğŸ‡¸",
    },
    { id: "spanish", name: t("nationalities.spanish"), flag: "ğŸ‡ªğŸ‡¸" },
    { id: "sri_lankan", name: t("nationalities.sri_lankan"), flag: "ğŸ‡±ğŸ‡°" },
    { id: "sudanese", name: t("nationalities.sudanese"), flag: "ğŸ‡¸ğŸ‡©" },
    { id: "surinamese", name: t("nationalities.surinamese"), flag: "ğŸ‡¸ğŸ‡·" },
    { id: "swazi", name: t("nationalities.swazi"), flag: "ğŸ‡¸ğŸ‡¿" },
    { id: "swedish", name: t("nationalities.swedish"), flag: "ğŸ‡¸ğŸ‡ª" },
    { id: "swiss", name: t("nationalities.swiss"), flag: "ğŸ‡¨ğŸ‡­" },
    { id: "syrian", name: t("nationalities.syrian"), flag: "ğŸ‡¸ğŸ‡¾" },
    { id: "taiwanese", name: t("nationalities.taiwanese"), flag: "ğŸ‡¹ğŸ‡¼" },
    { id: "tajikistani", name: t("nationalities.tajikistani"), flag: "ğŸ‡¹ğŸ‡¯" },
    { id: "tanzanian", name: t("nationalities.tanzanian"), flag: "ğŸ‡¹ğŸ‡¿" },
    { id: "thai", name: t("nationalities.thai"), flag: "ğŸ‡¹ğŸ‡­" },
    { id: "timorese", name: t("nationalities.timorese"), flag: "ğŸ‡¹ğŸ‡±" },
    { id: "togolese", name: t("nationalities.togolese"), flag: "ğŸ‡¹ğŸ‡¬" },
    { id: "tongan", name: t("nationalities.tongan"), flag: "ğŸ‡¹ğŸ‡´" },
    { id: "trinidadian", name: t("nationalities.trinidadian"), flag: "ğŸ‡¹ğŸ‡¹" },
    { id: "tunisian", name: t("nationalities.tunisian"), flag: "ğŸ‡¹ğŸ‡³" },
    { id: "turkish", name: t("nationalities.turkish"), flag: "ğŸ‡¹ğŸ‡·" },
    { id: "turkmenistani", name: t("nationalities.turkmenistani"), flag: "ğŸ‡¹ğŸ‡²" },
    { id: "tuvaluan", name: t("nationalities.tuvaluan"), flag: "ğŸ‡¹ğŸ‡»" },
    { id: "ugandan", name: t("nationalities.ugandan"), flag: "ğŸ‡ºğŸ‡¬" },
    { id: "ukrainian", name: t("nationalities.ukrainian"), flag: "ğŸ‡ºğŸ‡¦" },
    { id: "uruguayan", name: t("nationalities.uruguayan"), flag: "ğŸ‡ºğŸ‡¾" },
    { id: "uzbekistani", name: t("nationalities.uzbekistani"), flag: "ğŸ‡ºğŸ‡¿" },
    { id: "vanuatuan", name: t("nationalities.vanuatuan"), flag: "ğŸ‡»ğŸ‡º" },
    { id: "vatican", name: t("nationalities.vatican"), flag: "ğŸ‡»ğŸ‡¦" },
    { id: "venezuelan", name: t("nationalities.venezuelan"), flag: "ğŸ‡»ğŸ‡ª" },
    { id: "vietnamese", name: t("nationalities.vietnamese"), flag: "ğŸ‡»ğŸ‡³" },
    { id: "yemeni", name: t("nationalities.yemeni"), flag: "ğŸ‡¾ğŸ‡ª" },
    { id: "zambian", name: t("nationalities.zambian"), flag: "ğŸ‡¿ğŸ‡²" },
    { id: "zimbabwean", name: t("nationalities.zimbabwean"), flag: "ğŸ‡¿ğŸ‡¼" },
  ];

  const filteredNationalities = nationalities.filter((nationality) =>
    nationality.name.toLowerCase().includes(searchText.toLowerCase())
  );

  const handleNationalitySelect = (nationality: string) => {
    setSelectedNationalities((prev) => {
      if (prev.includes(nationality)) {
        // Remove nationality if already selected
        return prev.filter((n) => n !== nationality);
      } else {
        // Add nationality if not selected
        return [...prev, nationality];
      }
    });
  };

  const handleSave = () => {
    setFilterData({
      ...filterData,
      nationality: selectedNationalities,
    });
    onClose();
  };

  // Check if nationality is selected
  const isSelected = (nationality: string) => {
    return selectedNationalities.includes(nationality);
  };

  const renderNationalityItem = ({ item }: any) => (
    <TouchableOpacity
      style={[
        styles.nationalityItem,
        isSelected(item.name) && styles.selectedNationalityItem,
      ]}
      onPress={() => handleNationalitySelect(item.name)}
      activeOpacity={0.7}
    >
      <View style={styles.nationalityContent}>
        <Text style={styles.flag}>{item.flag}</Text>
        <Text
          style={[
            styles.nationalityText,
            isSelected(item.name) && styles.selectedNationalityText,
          ]}
        >
          {item.name}
        </Text>
      </View>
      {isSelected(item.name) && (
        <Ionicons name="checkmark" size={20} color={color.primary} />
      )}
    </TouchableOpacity>
  );

  return (
    <View style={styles.container}>
      {/* Header */}
      <View style={styles.header}>
        <TouchableOpacity onPress={onBack} style={styles.backButton}>
          <Ionicons name="arrow-back" size={24} color={color.black} />
        </TouchableOpacity>
        <Text style={styles.title}>{t("filters.nationality")}</Text>
        <TouchableOpacity onPress={onClose} style={styles.closeButton}>
          <Ionicons name="close" size={24} color={color.black} />
        </TouchableOpacity>
      </View>

      {/* Search Bar */}
      <View style={styles.searchContainer}>
        <View style={styles.searchInputContainer}>
          <Ionicons
            name="search"
            size={20}
            color={color.gray14}
            style={styles.searchIcon}
          />
          <TextInput
            style={styles.searchInput}
            value={searchText}
            onChangeText={setSearchText}
            placeholder={t("filters.searchNationality")}
            placeholderTextColor={color.gray14}
          />
        </View>
      </View>

      {/* Nationality List */}
      <FlatList
        data={filteredNationalities}
        renderItem={renderNationalityItem}
        keyExtractor={(item) => item.id}
        style={styles.list}
        showsVerticalScrollIndicator={false}
        ItemSeparatorComponent={() => <View style={styles.separator} />}
      />

      {/* Bottom Save Button */}
      <View style={styles.bottomContainer}>
        <TouchableOpacity
          style={[
            styles.saveButton,
            selectedNationalities.length === 0 && styles.saveButtonDisabled,
          ]}
          onPress={handleSave}
          activeOpacity={0.8}
          disabled={selectedNationalities.length === 0}
        >
          <Text
            style={[
              styles.saveButtonText,
              selectedNationalities.length === 0 &&
                styles.saveButtonTextDisabled,
            ]}
          >
            {t("save")}
          </Text>
        </TouchableOpacity>
      </View>
    </View>
  );
}

const styles = StyleSheet.create({
  container: {
    backgroundColor: color.white,
    borderTopLeftRadius: 20,
    borderTopRightRadius: 20,
    minHeight: SCREEN_HEIGHT * 0.85,
    paddingBottom: 34,
  },
  header: {
    flexDirection: "row",
    alignItems: "center",
    justifyContent: "space-between",
    paddingHorizontal: 20,
    paddingVertical: 20,
    borderBottomWidth: 1,
    borderBottomColor: "#F5F5F5",
  },
  title: {
    fontSize: 20,
    fontFamily: font.semiBold,
    color: color.black,
  },
  backButton: {
    width: 32,
    height: 32,
    alignItems: "center",
    justifyContent: "center",
  },
  closeButton: {
    width: 32,
    height: 32,
    alignItems: "center",
    justifyContent: "center",
  },
  searchContainer: {
    paddingHorizontal: 20,
    paddingTop: 20,
    paddingBottom: 16,
  },
  searchInputContainer: {
    flexDirection: "row",
    alignItems: "center",
    backgroundColor: "#F8F9FA",
    borderRadius: 12,
    paddingHorizontal: 16,
    paddingVertical: 12,
  },
  searchIcon: {
    marginRight: 12,
  },
  searchInput: {
    flex: 1,
    fontSize: 16,
    fontFamily: font.regular,
    color: color.black,
  },
  list: {
    flex: 1,
    paddingHorizontal: 20,
  },
  nationalityItem: {
    flexDirection: "row",
    alignItems: "center",
    justifyContent: "space-between",
    paddingVertical: 16,
    paddingHorizontal: 4,
  },
  nationalityContent: {
    flexDirection: "row",
    alignItems: "center",
    flex: 1,
  },
  flag: {
    fontSize: 20,
    marginRight: 16,
  },
  nationalityText: {
    fontSize: 16,
    fontFamily: font.regular,
    color: color.black,
    flex: 1,
  },
  separator: {
    height: 1,
    backgroundColor: "#F5F5F5",
    marginLeft: 52, // Aligns with text after flag
  },
  selectedNationalityItem: {
    backgroundColor: "#F0F9FF",
  },
  selectedNationalityText: {
    color: color.primary,
  },
  bottomContainer: {
    paddingHorizontal: 20,
    paddingTop: 24,
  },
  saveButton: {
    width: "100%",
    paddingVertical: 16,
    borderRadius: 12,
    alignItems: "center",
    backgroundColor: color.primary,
  },
  saveButtonDisabled: {
    backgroundColor: "#E5E5E5",
  },
  saveButtonText: {
    fontSize: 16,
    fontFamily: font.semiBold,
    color: color.white,
  },
  saveButtonTextDisabled: {
    color: "#9CA3AF",
  },
});
